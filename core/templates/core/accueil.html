 {% extends 'core/base.html' %}
{% load static humanize %}

{% block title %}Accueil - RestaurantPlus{% endblock %}

{% block content %}

<!-- Publicités -->
 {% if publicites %}
<div id="carouselPublicites" class="carousel slide mb-5" data-bs-ride="carousel">
  <div class="carousel-inner">
    {% for pub in publicites %}
    <div class="carousel-item {% if forloop.first %}active{% endif %}">
      {% if pub.lien %}
      <a href="{{ pub.lien }}" target="_blank" rel="noopener noreferrer">
        <img src="{{ pub.image.url }}" class="d-block w-100 rounded shadow-sm" alt="{{ pub.titre }}">
      </a>
      {% else %}
      <img src="{{ pub.image.url }}" class="d-block w-100 rounded shadow-sm" alt="{{ pub.titre }}">
      {% endif %}
      {% if pub.titre %}
      <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded">
        <h5>{{ pub.titre }}</h5>
      </div>
      {% endif %}
    </div>
    {% endfor %}
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselPublicites" data-bs-slide="prev">
    <span class="carousel-control-prev-icon"></span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselPublicites" data-bs-slide="next">
    <span class="carousel-control-next-icon"></span>
  </button>
</div>
{% endif %}


<!-- Section Plats -->
<section class="mb-5">
  <h2>Nos plats populaires</h2>
  <div class="row">
    {% for plat in plats|slice:":4" %}
    <div class="col-md-3">
      <div class="card mb-3 shadow-sm h-100">
        {% if plat.image %}
        <img src="{{ plat.image.url }}" class="card-img-top" alt="{{ plat.nom }}">
        {% else %}
        <img src="{% static 'images/default-plat.jpg' %}" class="card-img-top" alt="Image par défaut">
        {% endif %}
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ plat.nom }}</h5>
          <p class="card-text">{{ plat.description|truncatewords:15 }}</p>
          <p class="fw-bold mt-auto">{{ plat.prix|intcomma }} FCFA</p>
          <a href="{% url 'ajouter_au_panier' 'plat' plat.id %}" class="btn btn-primary mt-2">Ajouter au panier</a>
        </div>
      </div>
    </div>
    {% empty %}
    <p>Aucun plat disponible pour le moment.</p>
    {% endfor %}
  </div>
  <a href="{% url 'liste_plats' %}" class="btn btn-outline-primary">Voir tous les plats</a>
</section>

<!-- Section Produits du marché -->
<section class="mb-5">
  <h2>Produits du marché</h2>
  <div class="row">
    {% for produit in produits_marche|slice:":4" %}
    <div class="col-md-3">
      <div class="card mb-3 shadow-sm h-100">
        {% if produit.image %}
        <img src="{{ produit.image.url }}" class="card-img-top" alt="{{ produit.nom }}">
        {% else %}
        <img src="{% static 'images/default-produit.jpg' %}" class="card-img-top" alt="Image par défaut">
        {% endif %}
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ produit.nom }}</h5>
          <p class="fw-bold mt-auto">{{ produit.prix|intcomma }} FCFA</p>
          <a href="{% url 'ajouter_au_panier' 'marche' produit.id %}" class="btn btn-success mt-2">Ajouter au panier</a>
        </div>
      </div>
    </div>
    {% empty %}
    <p>Aucun produit disponible pour le moment.</p>
    {% endfor %}
  </div>
  <a href="{% url 'liste_produits_marche' %}" class="btn btn-outline-success">Voir tous les produits</a>
</section>

<!-- Section Vins -->
<section class="mb-5">
  <h2>Nos vins recommandés</h2>
  <div class="row">
    {% for vin in vins|slice:":4" %}
    <div class="col-md-3">
      <div class="card mb-3 shadow-sm h-100">
        {% if vin.image %}
        <img src="{{ vin.image.url }}" class="card-img-top" alt="{{ vin.nom }}">
        {% else %}
        <img src="{% static 'images/default-vin.jpg' %}" class="card-img-top" alt="Image par défaut">
        {% endif %}
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ vin.nom }}</h5>
          <p class="fw-bold mt-auto">{{ vin.prix|intcomma }} FCFA</p>
          <a href="{% url 'ajouter_au_panier' 'vin' vin.id %}" class="btn btn-warning mt-2">Ajouter au panier</a>
        </div>
      </div>
    </div>
    {% empty %}
    <p>Aucun vin disponible pour le moment.</p>
    {% endfor %}
  </div>
  <a href="{% url 'liste_vins' %}" class="btn btn-outline-warning">Voir tous les vins</a>
</section>

<!-- Section Cuisiniers -->
<section class="mb-5">
  <h2>Nos cuisiniers disponibles</h2>
  <div class="row">
    {% for cuisinier in cuisiniers|slice:":4" %}
    <div class="col-md-3">
      <div class="card mb-3 shadow-sm h-100">
        {% if cuisinier.image %}
        <img src="{{ cuisinier.image.url }}" class="card-img-top" alt="{{ cuisinier.nom }}">
        {% else %}
        <img src="{% static 'images/default-cuisinier.jpg' %}" class="card-img-top" alt="Image par défaut">
        {% endif %}
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ cuisinier.nom }}</h5>
          <p class="card-text">{{ cuisinier.bio|truncatewords:20 }}</p>
          <a href="{% url 'liste_cuisiniers' %}" class="btn btn-info mt-auto">Voir tous les cuisiniers</a>
        </div>
      </div>
    </div>
    {% empty %}
    <p>Aucun cuisinier disponible pour le moment.</p>
    {% endfor %}
  </div>
</section>

{% endblock %}
